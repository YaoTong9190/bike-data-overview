<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<style>
h1,
h2,
h3,
h4,
h5,
h6,
p,
blockquote {
    margin: 0;
    padding: 0;
}
body {
    font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", Arial, sans-serif;
    font-size: 13px;
    line-height: 18px;
    color: #737373;
    background-color: white;
    margin: 10px 13px 10px 13px;
}
table {
	margin: 10px 0 15px 0;
	border-collapse: collapse;
}
td,th {	
	border: 1px solid #ddd;
	padding: 3px 10px;
}
th {
	padding: 5px 10px;	
}

a {
    color: #0069d6;
}
a:hover {
    color: #0050a3;
    text-decoration: none;
}
a img {
    border: none;
}
p {
    margin-bottom: 9px;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    color: #404040;
    line-height: 36px;
}
h1 {
    margin-bottom: 18px;
    font-size: 30px;
}
h2 {
    font-size: 24px;
}
h3 {
    font-size: 18px;
}
h4 {
    font-size: 16px;
}
h5 {
    font-size: 14px;
}
h6 {
    font-size: 13px;
}
hr {
    margin: 0 0 19px;
    border: 0;
    border-bottom: 1px solid #ccc;
}
blockquote {
    padding: 13px 13px 21px 15px;
    margin-bottom: 18px;
    font-family:georgia,serif;
    font-style: italic;
}
blockquote:before {
    content:"\201C";
    font-size:40px;
    margin-left:-10px;
    font-family:georgia,serif;
    color:#eee;
}
blockquote p {
    font-size: 14px;
    font-weight: 300;
    line-height: 18px;
    margin-bottom: 0;
    font-style: italic;
}
code, pre {
    font-family: Monaco, Andale Mono, Courier New, monospace;
}
code {
    background-color: #fee9cc;
    color: rgba(0, 0, 0, 0.75);
    padding: 1px 3px;
    font-size: 12px;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    border-radius: 3px;
}
pre {
    display: block;
    padding: 14px;
    margin: 0 0 18px;
    line-height: 16px;
    font-size: 11px;
    border: 1px solid #d9d9d9;
    white-space: pre-wrap;
    word-wrap: break-word;
}
pre code {
    background-color: #fff;
    color:#737373;
    font-size: 11px;
    padding: 0;
}
sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:10px auto;
    }
}
@media print {
	body,code,pre code,h1,h2,h3,h4,h5,h6 {
		color: black;
	}
	table, pre {
		page-break-inside: avoid;
	}
}
</style>
<title>Week 4 Exercises</title>

</head>
<body>
<h1>Week 4 Exercises</h1>

<h2>Before you start</h2>

<p>Decide where you are going to store your work, i.e., any data sets that you download and modify, any scripts you might write or use, any other outputs that you create from the data. Options (not mutually exclusive) include:</p>

<ul>
<li>a standard folder on local storage on your laptop</li>
<li>in the cloud; e.g. Dropbox or Google Drive folder</li>
<li>in a versioned repository, such as git + GitHub</li>
</ul>


<p>Name your work folders clearly and create subfolders if necessary. Do you care if you lose the folder?</p>

<h2>Finding Data</h2>

<p>Data stores to use:</p>

<ul>
<li>City of Edinburgh Council (CEC) <a href="http://www.edinburghopendata.info/dataset">Open Data Store</a></li>
<li>CEC <a href="https://github.com/edinburghcouncil/datasets">GitHub repository</a></li>
</ul>


<p>And possibly</p>

<ul>
<li><a href="http://www.sns.gov.uk/default.aspx">Scottish Neighbourhood Statistics</a></li>
</ul>


<h3>Tasks</h3>

<p>Try to use data from the <strong>CEC data sets</strong> to answer the following questions <strong>about Inverleith</strong>.</p>

<ol>
<li>How many allotments are there?</li>
<li>How many leisure centres are there?</li>
<li>How many museums and art galleries?</li>
<li>How many public bike parking facilities?</li>
<li>Find out something interesting about Inverleith not already on this list.</li>
</ol>


<p>You may be able to do this by identifying relevant data sets in the CEC data stores and just looking at the data.</p>

<p>You may find that some of the data is geocoded using WGS84 latitude and longitude coordinates; e.g., <code>55.954419, -3.1735552</code>. If you just paste these coordinates into a Google search bar, it will return a little map of the location.</p>

<h2>Organising Tabular Data</h2>

<h3>First steps</h3>

<ol>
<li>Download the <code>Cepats 2013.xls</code> file from <a href="https://github.com/edinburghlivinglab/cyclehack/tree/master/CEPATS">CEPATS data</a></li>
<li>Import the file into Google Sheets (or use Libre Office or Excel). Create a new spreadsheet, then do <code>File &gt; Import &gt; Replace spreadsheet</code>.</li>
<li>Make a copy of the file and rename it, just in case you want to rewind to the original version at some point.</li>
<li>We are going to work with only two sheets: <code>IN0730</code> and <code>Survey Information</code>. Let's start with <code>IN0730</code></li>
</ol>


<h3>Working on <code>IN0730</code></h3>

<ol>
<li>First, get clear all formatting.</li>
<li>Next, get rid of all rows except the header rows (i.e., containing the column labels) and the ones starting with 'Abbeyhill' and ending with 'Wester Coates Walkway'.</li>
<li>Get rid of all the columns except:

<ol>
<li>the one with street names</li>
<li>the one headed 'PEDAL CYCLES'</li>
<li>the one headed 'CARS &amp; TAXIS'</li>
</ol>
</li>
<li>There are currently two header rows; collapse these into one</li>
</ol>


<h3>Working on <code>Survey Information</code></h3>

<ol>
<li>Delete all rows apart from the ones with street locations; i.e. 5-43.</li>
<li>Delete all columns apart from the street location one and the one labeled 'O.S. GRID REF.'</li>
<li>Duplicate the 'O.S. GRID REF.' column; e.g. create new column C and copy all of column B to C.</li>
</ol>


<h4>Converting OS Grid Ref to LatLong</h4>

<p>We want to just keep information to the left of the <code>/</code> in column B and just information to the right of the <code>/</code> in column C.</p>

<p>We'll use <code>Edit &gt; Find and replace</code> on each column separately, and we'll use regular expressions.</p>

<h6>Column A</h6>

<p><strong>Find</strong>: <code>/ [0-9]+</code></p>

<p><strong>Replace</strong>: <code></code></p>

<p>Search using regular expressions</p>

<p>Specific range: `'Survey Information'!B:B</p>

<h6>Column B</h6>

<p><strong>Find</strong>: <code>[0-9]+ /</code></p>

<p><strong>Replace</strong>: <code></code></p>

<p>Search using regular expressions</p>

<p>Specific range: `'Survey Information'!C:C</p>

<h4>Looking up LatLong</h4>

<p>We are now going to use the <a href="http://www.gridreferencefinder.com/batchConvert/batchConvert.php">GridReferenceFinder</a>. This requires that you paste your tabular data into a box and tick some options. It should look like this:</p>

<p><img src="images/batchConvert.png" width="500" alt="GridReferenceFinder" /></p>

<p>Paste the results back into a new sheet.</p>

<p>Next, you are are going to add the new data you've just created into <code>IN0730</code>. You want to add this new data as extra columns. The locations in <code>IN0730</code> should align with the street locations that you have just pasted in.</p>

<p>It should look something like this (ignore the 'Start' column): <img src="images/latlong1.png" width="600" alt="" />. You can now go ahead and delete the column with locations that pasted in, leaving just the new geo-coordinates. Give labels to these two new columns: <code>Latitude</code> and <code>Longitude</code>.</p>

<h2>Visualising</h2>

<p>Select column D 1:38</p>

<p>Data > Sort range from D1 to D38</p>

<p>sort by Column D A->Z</p>

<p>https://support.google.com/fusiontables/answer/2476954?hl=en&amp;topic=2569513&amp;ctx=topic</p>

<p>https://www.google.com/fusiontables/data?docid=1BDnT5U1Spyaes0Nj3DXciJKa_tuu7CzNRXWdVA#map:id=3</p>

<p><a href="https://support.google.com/fusiontables/answer/2571232?hl=en">Fusion Tables</a></p>

<p>Change feature styles > Map marker icons > Column > Use icon specified in a column > Select > Icon</p>

<p>Filter > Catagory
choose either <code>cars</code> or <code>pedal cycles</code></p>
</body>
</html>